#ifndef DISPLAY_H
#define DISPLAY_H

#include <Arduino.h>
#include <SSD1306.h>

#define WIDTH 128
#define HEIGHT 64
#define PAGES 8

struct Status {
    bool shown;
    String text;
    bool status;

    uint8_t x;
    uint8_t y;
    const uint8_t *img;
    uint8_t width;
    uint8_t height;
};

class Display {
  public:
    static Display &Instance();

    Display();

    Display(Display const &) = delete;
    void operator=(Display const &) = delete;

    void setup() {}
    void loop();

    void setMonitText(String text);
    void setMqttConnected(bool b);
    void setWifiConnected(bool b);
    void setSoilWetness(bool b);

  private:
    void render(Status *s);

    SSD1306 m_display;
    Status m_monit;
    Status m_wifi;
    Status m_mqtt;
    Status m_soil_wetness;
    Status m_power;
    Status m_logo34;
    Status m_logo68;

    long int m_next_update_time;
};

// 'rog', 68x34px
// clang-format off
const unsigned char epd_bitmap_rog [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0xff, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0xff, 0x80, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x7f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xf0, 0x03, 0x80, 0x00,
	0x00, 0x00, 0x00, 0x03, 0xff, 0x80, 0x0f, 0x80, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xfe, 0x00, 0x7f,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0xf8, 0x03, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0xe0,
	0x0f, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x80, 0x7f, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x01,
	0xfe, 0x01, 0xfc, 0x78, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, 0x07, 0xf1, 0xf8, 0x00, 0x00, 0x00,
	0x00, 0x07, 0xf0, 0x3f, 0x87, 0xf8, 0x00, 0x40, 0x00, 0x00, 0x1f, 0xc0, 0xfe, 0x3f, 0xf0, 0x00,
	0x60, 0x00, 0x00, 0x3f, 0x03, 0xf8, 0xff, 0xf0, 0x00, 0x38, 0x00, 0x00, 0x7c, 0x0f, 0xc3, 0xef,
	0xe0, 0x00, 0x38, 0x20, 0x01, 0xf8, 0x3f, 0x1f, 0x0f, 0xc0, 0x00, 0x1c, 0x38, 0x03, 0xe0, 0xfc,
	0x78, 0x1f, 0xc0, 0x00, 0x1f, 0x1e, 0x07, 0xc3, 0xf1, 0xe0, 0x1f, 0x80, 0x00, 0x0f, 0x8f, 0xff,
	0x0f, 0xc7, 0x00, 0x3f, 0x80, 0x00, 0x03, 0xcf, 0xfe, 0x3f, 0x18, 0x00, 0x7f, 0x00, 0x00, 0x00,
	0xe7, 0xf8, 0xfc, 0x00, 0x00, 0xfe, 0x00, 0x00, 0x00, 0x33, 0xf3, 0xf0, 0x00, 0x01, 0xfc, 0x00,
	0x00, 0x00, 0x03, 0xe7, 0xf0, 0x00, 0x03, 0xf8, 0x00, 0x00, 0x00, 0x01, 0xe7, 0xff, 0x00, 0x07,
	0xf8, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x70, 0x0f,
	0xff, 0xff, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x7f, 0xff, 0x80, 0x00, 0x00, 0x00, 0x00,
	0x0c, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00
};

// 'leeve', 34x34px
const unsigned char epd_bitmap_leeve [] PROGMEM = {
	0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x03, 0xe0, 0x00, 0x00,
	0x00, 0x0f, 0xe0, 0x00, 0x00, 0x00, 0x3f, 0xf0, 0x00, 0x00, 0x00, 0xff, 0xf0, 0x00, 0x00, 0x03,
	0xff, 0xf0, 0x00, 0x00, 0x0f, 0xff, 0xf8, 0x00, 0x00, 0x1f, 0xff, 0xf8, 0x00, 0x00, 0x3f, 0xff,
	0xf8, 0x00, 0x00, 0x7f, 0xff, 0xf8, 0x00, 0x00, 0xff, 0xfb, 0xf8, 0x00, 0x01, 0xff, 0xff, 0xf8,
	0x00, 0x03, 0xff, 0xf7, 0xf8, 0x00, 0x03, 0xff, 0xef, 0xf8, 0x00, 0x03, 0xff, 0xef, 0xf8, 0x00,
	0x07, 0xff, 0xdf, 0xf8, 0x00, 0x07, 0xff, 0xbf, 0xf8, 0x00, 0x07, 0xff, 0x3f, 0xf0, 0x00, 0x07,
	0xfe, 0x7f, 0xf0, 0x00, 0x07, 0xfc, 0xff, 0xe0, 0x00, 0x07, 0xf9, 0xff, 0xe0, 0x00, 0x07, 0xf3,
	0xff, 0xc0, 0x00, 0x07, 0xe7, 0xff, 0x80, 0x00, 0x03, 0xcf, 0xff, 0x00, 0x00, 0x03, 0xbf, 0xfe,
	0x00, 0x00, 0x03, 0x3f, 0xfc, 0x00, 0x00, 0x00, 0x7f, 0xf0, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00,
	0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00,
	0x01, 0x80, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00
};

const uint8_t Signal816[16] PROGMEM = {
    0xFE,0x02,0x92,0x0A,0x54,0x2A,0x38,0xAA,0x12,0xAA,0x12,0xAA,0x12,0xAA,0x12,0xAA
};

const uint8_t Msg816[16] PROGMEM = {
    0x1F,0xF8,0x10,0x08,0x18,0x18,0x14,0x28,0x13,0xC8,0x10,0x08,0x10,0x08,0x1F,0xF8
};

const uint8_t Bat816[16] PROGMEM = {
    0x0F,0xFE,0x30,0x02,0x26,0xDA,0x26,0xDA,0x26,0xDA,0x26,0xDA,0x30,0x02,0x0F,0xFE
};

const uint8_t Bluetooth88[8] PROGMEM = {
    0x18,0x54,0x32,0x1C,0x1C,0x32,0x54,0x18
};

const uint8_t GPRS88[8] PROGMEM = {
    0xC3,0x99,0x24,0x20,0x2C,0x24,0x99,0xC3
};

const uint8_t Alarm88[8] PROGMEM = {
    0xC3,0xBD,0x42,0x52,0x4E,0x42,0x3C,0xC3
};

// clang-format on

#endif
